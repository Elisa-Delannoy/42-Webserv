server {
    listen 8080;
    server_name  webserv.local  www.webserv.local;

    root /www;
    index index.html index.php;

    # Taille max POST (upload)
    client_max_body_size 20M;

    # Pages d'erreur personnalisées (fichiers relatifs à root)
    error_page 404 /errors/404.html;
    error_page 413 /errors/413.html;
    error_page 500 /errors/500.html;

    # Emplacement des fichiers uploadés (pour la directive upload)
    upload_store /www/uploads;

    # Location pour les fichiers PHP -> passer à un CGI (php-cgi)
    location ~ \.php$ {
        root /www;
        # chemin vers l'exécutable CGI (adapter selon ton système)
        cgi_pass /usr/bin/php-cgi;
        allow_methods GET POST;
        client_max_body_size 10M;
    }

    # Location pour les uploads (autorise POST, active autoindex pour vérifier)
    location /uploads {
        root /www;
        allow_methods GET POST DELETE;
        autoindex on;
        upload_store /www/uploads;
    }

    # Location pour fichiers statiques (images, css, js)
    location /static {
        root /www;
        allow_methods GET;
        autoindex off;
    }

    # Bloquer méthodes non désirées par défaut
    location / {
        root /www;
        allow_methods GET POST DELETE;
        autoindex off;
    }
}

